# 공부 내용 
이번 프로젝트에서 시스템 모니터링과 성능 측정을 위해 Prometheus를 학습하였습니다.

# Prometheus

Prometheus는 오픈 소스 시스템 모니터링 및 알림 도구입니다.  
우리가 이를 사용하는 목적은 애플리케이션이나 시스템에서 발생하는 다양한 데이터를 시간에 따른 변화로 수집하고 저장하는 것입니다.  
이를 통해 애플리케이션의 성능을 분석하고 모니터링할 수 있습니다.

## 프로메테우스의 주요 기능

- **멀티-디멘셔널 데이터 모델**:  
  각 데이터(시간 시리즈)는 메트릭 이름과 키/값 쌍(label)으로 식별됩니다.

- **유연한 쿼리 언어: PromQL**:  
  데이터를 분석하고 시각화하기 위한 강력한 쿼리 언어입니다.

- **독립적인 저장 방식**:  
  분산 스토리지 없이도 단일 서버가 독립적으로 동작할 수 있습니다.

- **HTTP 기반 풀(Pull) 모델**:  
  데이터 수집 시 애플리케이션에서 데이터를 직접 가져오는 방식입니다.

- **푸시(Push) 방식 지원**:  
  임시 작업(예: 배치 작업)의 데이터를 푸시 게이트웨이를 통해 전달받을 수 있습니다.

- **서비스 디스커버리 및 정적 구성**:  
  데이터를 수집할 대상(target)을 자동으로 탐지하거나, 수동으로 구성할 수 있습니다.

- **그래프 및 대시보드 지원**:  
  수집한 데이터를 시각화할 수 있는 다양한 도구를 제공합니다(Grafana와 잘 연동됨).

## 메트릭(Metrics)이란?

메트릭은 숫자로 된 측정 값입니다.  
예를 들어, 웹 서버에서는 요청 처리 시간(request time)이 메트릭이 될 수 있고, 데이터베이스에서는 활성 연결(active connections)이나 활성 쿼리(active queries) 수가 메트릭이 될 수 있습니다.

시간 시리즈(Time Series)는 이러한 메트릭 값을 시간에 따라 기록하는 것을 의미합니다.  
예를 들어, 웹 애플리케이션이 느려지는 이유를 찾고 싶다면, 먼저 요청 수(request count)라는 메트릭을 살펴볼 수 있습니다.  
요청 수가 많아지면 애플리케이션이 느려질 가능성이 있으므로, 서버를 더 추가해 부하를 분산할 수 있습니다.

따라서 메트릭은 시스템이 어떻게 동작하고 있는지를 이해하는 데 핵심적인 역할을 합니다.

## 프로메테우스의 구성 요소

프로메테우스는 여러 가지 구성 요소로 이루어져 있으며, 필요에 따라 선택적으로 사용할 수 있습니다. 주요 구성 요소는 다음과 같습니다:

- **Prometheus 서버**  
  메트릭 데이터를 수집(scrape)하고 저장하며, 쿼리를 처리합니다.

- **클라이언트 라이브러리**  
  애플리케이션에 직접 메트릭 수집 로직을 추가하기 위한 라이브러리입니다.

- **푸시 게이트웨이(Push Gateway)**  
  단기 작업(예: 크론 작업)에서 데이터를 푸시(push) 방식으로 수집합니다.

- **익스포터(Exporter)**  
  HAProxy, StatsD, Graphite와 같은 서비스에서 메트릭을 수집하기 위한 도구입니다.

- **알림 관리자(Alertmanager)**  
  경고(alert)를 관리하고 알림을 보냅니다(예: 이메일, 슬랙).

- **시각화 도구**  
  Grafana와 같은 도구로 수집된 데이터를 시각화할 수 있습니다.

## 프로메테우스의 아키텍처

### Prometheus Server (프로메테우스 서버)
이 아키텍처의 핵심 컴포넌트입니다.  
프로메테우스 서버는 다음과 같은 역할을 수행합니다:
- **데이터 수집 (Retrieval)**: 모니터링 대상(target)에서 메트릭 데이터를 HTTP 프로토콜로 Pull(끌어오기) 방식으로 가져옵니다.
- **데이터 저장 (TSDB)**: 수집된 데이터를 **시간 시리즈 데이터베이스(Time Series Database)**에 저장합니다.
- **HTTP 서버**: 쿼리 언어(PromQL)를 통해 데이터를 조회하거나 외부 도구(Grafana 등)에서 데이터를 요청할 수 있도록 API를 제공합니다.
